<!DOCTYPE html>
<html>
<head>
    <style>
    #queryInput {
        padding: 10px;
        border-radius: 20px;
        border: 1px solid #ccc;
        flex-grow: 1;
        margin-right: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    #queryForm {
      display: flex;
      justify-content: space-between;
    }
    
    </style>
    <title>Audio Stream from FastAPI</title>
</head>
<body>
    <div id="chat-container">
        <div id="chat-box">
            <!-- Chat messages will appear here -->
        </div>
        <form id="queryForm">
            <input type="text" id="queryInput" placeholder="Enter your query here">
            <button type="submit">Send</button>
        </form>
        <audio id="audioPlayer" controls style="display:none;">
            <source id="audioSource" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
    </div>
<script>
document.addEventListener("DOMContentLoaded", function() {
  const form = document.getElementById("queryForm");
  const chatBox = document.getElementById("chat-box");
  const audioSource = document.getElementById("audioSource");
  const audioPlayer = document.getElementById("audioPlayer");

  form.addEventListener("submit", function(event) {
    event.preventDefault();
    const query = document.getElementById("queryInput").value;
    const url = `http://localhost:8000/chat?query=${encodeURIComponent(query)}`;

    // Display user's message
    const userMessage = document.createElement("div");
    userMessage.className = "message user-message";
    userMessage.textContent = query;
    chatBox.appendChild(userMessage);

    // Fetch and display bot's audio and text response
    audioSource.src = url;
    audioPlayer.load();
    audioPlayer.play();

    // For demonstration, displaying a text message from bot
    // In a real application, you would fetch this from the server
    const botMessage = document.createElement("div");
    botMessage.className = "message bot-message";
    botMessage.textContent = "Bot's response..."; // Replace with actual text from the bot
    chatBox.appendChild(botMessage);
  });
});

</script>
</body>
</html>